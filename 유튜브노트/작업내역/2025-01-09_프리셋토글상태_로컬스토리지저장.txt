작업 날짜: 2025-01-09
작업명: 프리셋 토글 상태 로컬스토리지 저장 기능

구현 내용:
최소 모드와 노트 모드 토글 상태를 로컬스토리지에 저장하고 페이지 로드시 복원하는 기능 구현

수정 파일 및 변경 내용:

1. client/src/components/SettingsPanel.tsx

   추가됨:
   const [presetStates, setPresetStates] = useState<{ 최소: boolean; 노트: boolean }>({
     최소: false,
     노트: false
   });

   useEffect(() => {
     const savedPresetStates = localStorage.getItem('presetToggleStates');
     if (savedPresetStates) {
       try {
         const states = JSON.parse(savedPresetStates);
         setPresetStates(states);
         
         if (states.최소) {
           const 새설정 = {
             상단부: { 제목표시: false, 부제목표시: false, 부제목내용: settings.상단부?.부제목내용 || "동영상을 보면서 타임스탬프와 함께 노트를 작성하세요" },
             검색창: { 유지: false },
             재생컨트롤: { 전체표시: false, 볼륨: false, 속도: false, 녹화: false, 도장: false, 편집: false },
             노트영역: { 표시: false },
             화면텍스트: { 
               패널표시: true, 
               좌표설정: false, 
               스타일설정: true, 
               빠른설정: true, 
               빠른설정위치: "정중앙",
               지속시간: true,
               글자크기여백: true,
               색상설정: true,
               배경투명도: true
             },
             프리셋: settings.프리셋 || { 최소모드명: "최소 모드", 노트모드명: "노트 모드" },
           };
           onSettingsChange(새설정);
         } else if (states.노트) {
           const 새설정 = {
             상단부: { 제목표시: false, 부제목표시: false, 부제목내용: settings.상단부?.부제목내용 || "동영상을 보면서 타임스탬프와 함께 노트를 작성하세요" },
             검색창: { 유지: false },
             재생컨트롤: { 전체표시: true, 볼륨: true, 속도: true, 녹화: false, 도장: false, 편집: false },
             노트영역: { 표시: true },
             화면텍스트: { 
               패널표시: false, 
               좌표설정: false, 
               스타일설정: false, 
               빠른설정: false, 
               빠른설정위치: "정중앙",
               지속시간: false,
               글자크기여백: false,
               색상설정: false,
               배경투명도: false
             },
             프리셋: settings.프리셋 || { 최소모드명: "최소 모드", 노트모드명: "노트 모드" },
           };
           onSettingsChange(새설정);
         }
       } catch (error) {
         console.error('프리셋 상태 로드 실패:', error);
       }
     }
   }, []);

   const updatePresetStates = (newStates: { 최소: boolean; 노트: boolean }) => {
     setPresetStates(newStates);
     localStorage.setItem('presetToggleStates', JSON.stringify(newStates));
   };

   수정됨:
   변경 전:
   const 프리셋선택 = (프리셋: "최소" | "노트") => {
     setSelectedPreset(selectedPreset === 프리셋 ? null : 프리셋);
   };

   변경 후:
   const 프리셋선택 = (프리셋: "최소" | "노트") => {
     const isCurrentlyActive = presetStates[프리셋];
     const newStates = {
       최소: 프리셋 === "최소" ? !isCurrentlyActive : false,
       노트: 프리셋 === "노트" ? !isCurrentlyActive : false
     };
     
     updatePresetStates(newStates);
     
     if (newStates[프리셋]) {
       setSelectedPreset(프리셋);
       프리셋적용(프리셋);
     } else {
       setSelectedPreset(null);
       프리셋적용("기본");
     }
   };

   변경 전:
   <Button 
     variant={selectedPreset === "최소" ? "default" : "outline"} 
     size="sm" 
     onClick={() => 프리셋선택("최소")}
   >
     {settings.프리셋?.최소모드명 || "최소 모드"}
   </Button>

   변경 후:
   <Button 
     variant={presetStates.최소 ? "default" : "outline"} 
     size="sm" 
     onClick={() => 프리셋선택("최소")}
     className={presetStates.최소 ? "bg-blue-500 hover:bg-blue-600" : ""}
   >
     {presetStates.최소 ? "✓ " : ""}{settings.프리셋?.최소모드명 || "최소 모드"}
   </Button>

   변경 전:
   <Button variant="outline" size="sm" onClick={() => 프리셋적용("전체")}>
     전체 모드
   </Button>

   변경 후:
   <Button variant="outline" size="sm" onClick={() => {
     updatePresetStates({ 최소: false, 노트: false });
     프리셋적용("전체");
   }}>
     전체 모드
   </Button>

   프리셋적용 함수 화면텍스트 속성 추가:
   최소 모드와 노트 모드의 화면텍스트 객체에 지속시간, 글자크기여백, 색상설정, 배경투명도 속성 추가

데이터 구조:
localStorage 키: presetToggleStates
값: { 최소: boolean, 노트: boolean }
전역 설정으로 저장되어 모든 비디오에서 동일하게 적용

추가된 기능:
- 최소 모드/노트 모드 토글 on/off 상태 저장
- 페이지 새로고침시 토글 상태 복원
- 토글 활성화시 체크 표시와 색상 변경
- 토글 비활성화시 기본 설정으로 복원
- 전체 모드나 초기화 선택시 모든 토글 해제