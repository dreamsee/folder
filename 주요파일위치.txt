YouTube 노트 앱 주요 파일 위치 및 코드 매핑
===========================================

=== 1. 기본 파일 분류 ===

메인 페이지:
- client/src/pages/HomePage.tsx: 전체 레이아웃과 상태 관리

핵심 컴포넌트:
- client/src/components/NoteArea.tsx: 노트 영역 및 재생 컨트롤
- client/src/components/YouTubePlayer.tsx: YouTube 플레이어
- client/src/components/VideoLoader.tsx: 영상 검색 및 로딩

UI 컴포넌트:
- client/src/components/SettingsPanel.tsx: 우측 설정 패널
- client/src/components/TextOverlay.tsx: 화면 텍스트 오버레이
- client/src/components/OverlayInput.tsx: 오버레이 입력 패널
- client/src/components/ChapterBar.tsx: YouTube 챕터 바
- client/src/components/TimeSkipControls.tsx: 영상 건너뛰기
- client/src/components/FavoriteManager.tsx: 즐겨찾기 관리
- client/src/components/ScreenLock.tsx: 화면 잠금

모달 및 입력:
- client/src/components/TimestampEditModal.tsx: 타임스탬프 편집 모달
- client/src/components/CommentModal.tsx: 댓글 상세보기 모달 (평가 시스템)
- client/src/components/CommentInputModal.tsx: 댓글 입력 모달 (별점 선택)
- client/src/components/FolderSelector.tsx: 폴더 선택기
- client/src/components/CoordinateInput.tsx: 좌표 입력
- client/src/components/PositionGrid.tsx: 위치 그리드
- client/src/components/TabLayoutSettings.tsx: 탭 레이아웃 설정 모달 (기능 재배치, 탭명 변경, 표시/숨김)

녹화 기능:
- client/src/components/RecordingMode.tsx: 녹화 모드
- client/src/components/RecordingSessionList.tsx: 녹화 세션 목록
- client/src/components/RecordingSessionCard.tsx: 녹화 세션 카드

유틸리티:
- client/src/components/SimpleNoteArea.tsx: 타임스탬프 로직 참고용
- client/src/components/SimpleShareArea.tsx: 공유 노트 로직 참고용
- client/src/components/NoteOverlayPanel.tsx: 오버레이 노트 입력 패널
- client/src/components/ErrorBoundary.tsx: 에러 경계
- client/src/components/Notification.tsx: 알림
- client/src/components/DebugLogPanel.tsx: 모바일 디버그 로그
- client/src/lib/youtubeUtils.ts: YouTube 유틸리티 (formatTime 등)
- client/src/utils/chapterParser.ts: 챕터 파싱

테스트 페이지:
- client/src/pages/TestSharePage.tsx: 댓글 시스템 테스트 페이지
- client/src/pages/TestTimestampPage.tsx: 타임스탬프 기능 테스트 페이지
- client/src/pages/TestOverlayPage.tsx: 텍스트 오버레이 고급 테스트 페이지 (좌표 입력, 정렬, 전체화면, 커스텀 진행바)

서버:
- server/index.ts: Express 서버 메인
- server/routes.ts: API 라우트

=== 2. 기능별 코드 위치 매핑 ===

🎯 타임스탬프 자동 실행 시스템:
- NoteArea.tsx:570-607 requestAnimationFrame 기반 고정밀 추적 시스템
- NoteArea.tsx:281-567 processTimestamps() 통합 타임스탬프 처리 함수
- NoteArea.tsx:233-278 detectManualMove() 수동 이동 감지
- NoteArea.tsx:295-306 우선순위 기반 타임스탬프 찾기 (lastActiveIndex + 1부터 체크)
- NoteArea.tsx:334-491 타임스탬프 진입 처리 (currentStamp && isDifferentTimestamp)
- NoteArea.tsx:494-563 타임스탬프 이탈 처리 (!currentStamp && activeTimestamp)
- NoteArea.tsx:1180-1360 더블클릭 핸들러 (handleNoteClick 내부)
- NoteArea.tsx:1282-1283 더블클릭시 lastActiveIndex 설정 (clickedIndex - 1로 설정 필수)
- NoteArea.tsx:1234-1250 더블클릭시 타임스탬프 설정 즉시 적용
- NoteArea.tsx:1308-1323 더블클릭시 정지 액션 즉시 실행
- NoteArea.tsx:855 addTimestamp() 도장 버튼 함수
- NoteArea.tsx:945 openTimestampModal() 편집 버튼
- YouTubePlayer.tsx:커스텀바렌더링 커스텀 진행바 하이라이트
- HomePage.tsx:timestamps상태 timestamps 상태 관리
→ 수정 시 주의:
  1. lastActiveIndex + 1 체크 로직 절대 변경 금지
  2. 더블클릭시 clickedIndex - 1 설정 필수
  3. 타임스탬프 설정 즉시 적용 필수
  4. 이탈시 재생 기본값 복원 변경 금지

📱 화면 오버레이 시스템:
- TextOverlay.tsx:전체컴포넌트 텍스트 표시 로직 (회전 기능 포함)
- TextOverlay.tsx:57-64 시간 기반 오버레이 필터링
- TextOverlay.tsx:125-177 getPositionStyle() 위치 및 회전 CSS 변환
- OverlayInput.tsx:전체컴포넌트 입력 패널 로직 (타임스탬프+텍스트 추출 포함)
- OverlayInput.tsx:77-110 updateExistingOverlay() 실시간 오버레이 업데이트 (시간 정보 보존)
- OverlayInput.tsx:53 rotation 상태 (-180~180도 회전 각도)
- OverlayInput.tsx:468-478 각도 슬라이더 UI (5도 단위)
- OverlayInput.tsx:127-173 parseTimestamps() 타임스탬프+설명텍스트 파싱
- OverlayInput.tsx:186-204 selectTimestamp() 설명텍스트 자동입력 & 실제지속시간 계산
- OverlayInput.tsx:555-577 지속시간 표시 (정수/소수점 이중표시)
- OverlayInput.tsx:590 "타임스탬프+텍스트 가져오기" 버튼
- OverlayInput.tsx:625-643 타임스탬프 선택 모달 (설명텍스트 미리보기 포함)
- NoteOverlayPanel.tsx:전체컴포넌트 오버레이 노트 입력 패널
- SettingsPanel.tsx:화면텍스트섹션 오버레이 설정 UI
- HomePage.tsx:오버레이상태들 오버레이 관련 상태 관리
- TestOverlayPage.tsx:64-88 플레이어 시간 업데이트 useEffect (currentTime, duration, isPlaying)
- TestOverlayPage.tsx:186-188 실시간 편집 업데이트 useEffect (설정값 변경시 즉시 반영)
- TestOverlayPage.tsx:150-184 updateEditingOverlay() 편집 중 오버레이 실시간 수정 (시작/종료 시간 기반)
- TestOverlayPage.tsx:479-485 노트 적용 버튼으로 즉시 편집 모드 진입 (현재 시간 + 1초)
- TestOverlayPage.tsx:306-347 editOverlay() 기존 오버레이 편집 모드 진입 (시간 분해)
- TestOverlayPage.tsx:30-55 localStorage 저장/로드 함수 (비디오별 오버레이 관리)
- TestOverlayPage.tsx:218-220 getTimeInSeconds() 4자리 시간 계산 헬퍼 함수
- TestOverlayPage.tsx:478-484 TextOverlay 컴포넌트 연동 (currentTime, isPlaying 전달)
- TestOverlayPage.tsx:좌표입력섹션 coordinates 상태와 X,Y 숫자 입력 필드 (0-100 범위)
- TestOverlayPage.tsx:정렬버튼섹션 textAlign 상태와 좌측/중앙/우측 선택 버튼 UI
- TestOverlayPage.tsx:180-212 전체화면 토글 함수 (브라우저 Fullscreen API)
- TestOverlayPage.tsx:774-790 전체화면 버튼 UI (영상 우측 하단 Maximize/Minimize)
- TestOverlayPage.tsx:780-781 전체화면 시 버튼 크기 확대 (p-1.6, bottom-2으로 YouTube 버튼을 가림)
- TestOverlayPage.tsx:656-660 글자 크기 범위 확장 (6-96px, 1px 단위 조정)
- TestOverlayPage.tsx:674-678 여백 설정 (4-20px, 1px 단위 조정)
- TestOverlayPage.tsx:756-922 4자리 시간 입력 컴포넌트 (10초/1초/0.1초/0.01초 단위별 조절)
- TestOverlayPage.tsx:952-954 오버레이 목록에서 소수점 시간 표시 (toFixed(2))
- TextOverlay.tsx:77-82 전체화면 스케일링 수정 (screenScale 무시, 실제 컨테이너 크기만 반영)
- TextOverlay.tsx:268 텍스트 자동 줄바꿈 방지 (width: max-content로 텍스트 길이에 맞춰 자동 폭 조정)
- TestOverlayPage.tsx:747-763 커스텀 진행바 (클릭 탐색, 전체화면 지원)
- TabLayoutSettings.tsx:전체컴포넌트 탭 커스터마이징 모달 (기능 재배치, 탭명 변경, 표시/숨김)
→ 수정 시 주의:
  1. 시간 입력은 4자리 분해 방식 (tens/ones/tenths/hundredths)으로 관리
  2. getTimeInSeconds() 함수로 4자리 값을 초 단위로 변환 필수
  3. 노트 적용 시 현재 영상 시간 기반으로 자동 시간 설정
  4. 편집 모드 진입 시 시간 분해 로직과 editingId 설정 필수
  5. localStorage는 비디오 ID별로 분리 저장 (overlays_${videoId})
  6. 실시간 업데이트는 0.5초 디바운싱으로 과도한 저장 방지
  7. CSS transform에서 회전과 위치 변환 조합 시 순서 중요
  8. TestOverlayPage는 currentTime 업데이트가 필수 (TextOverlay 필터링용)
  9. 전체화면 시 aspectRatio: '16/9' 유지로 화면 비율 왜곡 방지
  10. 전체화면 진입/종료 시 playerContainerRef DOM 요소 필수
  11. 좌표 입력은 0-100 범위로 제한, 백분율 기반 위치 계산
  12. 전체화면에서 screenScale 무시하여 일관된 텍스트 크기 유지
  13. 텍스트 자동 줄바꿈 방지로 의도하지 않은 줄바꿈 차단 (width: max-content 적용)
  14. 탭 설정 모달 복구 완료 (모바일 안정성 확보)

🎬 영상 로딩 및 재생:
- VideoLoader.tsx:handleVideoSelect 영상 선택 및 시청횟수 증가
- VideoLoader.tsx:283-329 handleVideoSelect() 영상 선택 및 검색 결과 처리 로직
- VideoLoader.tsx:114-120 videoId 필터링 (undefined 제거)
- VideoLoader.tsx:310-320 keepSearchResults 설정에 따른 검색 결과 유지/닫기
- YouTubePlayer.tsx:loadVideoById YouTube API 영상 로딩
- YouTubePlayer.tsx:onPlayerStateChange 재생 상태 변화 처리
- FavoriteManager.tsx:handleVideoPlay 즐겨찾기 영상 재생
- HomePage.tsx:currentVideoId currentVideoId 상태 관리

⚙️ 설정 관리:
- SettingsPanel.tsx:전체컴포넌트 모든 설정 UI
- SettingsPanel.tsx:18-21 UISettings 인터페이스 정의 (검색창.목록유지 포함)
- SettingsPanel.tsx:577-600 검색창 유지 설정 및 하위 "목록 열어두기" 토글
- SettingsPanel.tsx:589-600 목록유지 토글 (검색창 유지가 ON일 때만 표시)
- SettingsPanel.tsx:783-790 지속시간 토글 (스타일설정 섹션 맨 아래)
- SettingsPanel.tsx:1080-1170 프리셋 설정 저장 로직 (최소모드/노트모드)
- SettingsPanel.tsx:1200-1270 실시간 프리셋 업데이트 (handleSettingChange)
- SettingsPanel.tsx:savePresetSettings() 프리셋별 설정 저장 함수
- HomePage.tsx:uiSettings UISettings 상태 관리
- HomePage.tsx:279 keepSearchResults prop 전달 (목록유지 설정 연결)
- NoteArea.tsx:재생기본값적용 새 영상 로드시 기본값 적용
- YouTubePlayer.tsx:설정동기화 플레이어 설정 동기화

🎵 볼륨/속도 제어:
- NoteArea.tsx:1362-1377 handleVolumeChange 볼륨 슬라이더
- NoteArea.tsx:1408-1421 handleSpeedChange 속도 슬라이더
- NoteArea.tsx:109-111 userSettings 사용자 설정 상태
- NoteArea.tsx:플레이어동기화useEffect 플레이어와 UI 동기화
→ 중복 주의: 볼륨/속도 변경이 여러 곳에서 발생하므로 동기화 확인 필수

📊 챕터 및 네비게이션:
- ChapterBar.tsx:전체컴포넌트 챕터 표시 및 페이지네이션
- chapterParser.ts:전체파일 챕터 파싱 로직
- YouTubePlayer.tsx:챕터연동 챕터 데이터 처리

🎥 녹화 시스템:
- RecordingMode.tsx:녹화토글 녹화 시작/중지
- RecordingSessionList.tsx:전체컴포넌트 세션 목록 관리
- RecordingSessionCard.tsx:전체컴포넌트 개별 세션 카드
- HomePage.tsx:녹화상태 녹화 관련 상태

🔧 타임스탬프 생성 및 편집:
- NoteArea.tsx:855 addTimestamp() 도장 버튼으로 타임스탬프 생성
- NoteArea.tsx:1425-1449 지속시간 입력 컨트롤
- TimestampEditModal.tsx:994 addTimestampFromModal() 편집 모달에서 생성
- TimestampEditModal.tsx:전체컴포넌트 타임스탬프 편집 UI

📝 노트 영역 UI:
- NoteArea.tsx:1682-1703 노트 영역 Textarea 컴포넌트
- NoteArea.tsx:1697-1702 스크롤 관련 스타일 (scrollbar-hide, WebkitOverflowScrolling)
- index.css:118-129 스크롤바 숨기기 유틸리티 클래스 (.scrollbar-hide)
→ 수정 시 주의: 터치 스크롤 기능은 유지하면서 스크롤바만 숨김

🎮 재생 컨트롤:
- NoteArea.tsx:1453-1474 녹화 버튼
- NoteArea.tsx:1477-1488 도장 버튼
- NoteArea.tsx:1490-1500 편집 버튼
- NoteArea.tsx:재생컨트롤UI 볼륨/속도 슬라이더 UI

🔍 우선순위 및 순차 실행:
- NoteArea.tsx:lastActiveIndex lastActiveIndex 상태 (타임스탬프 우선순위)
- NoteArea.tsx:우선순위검색로직 우선순위 기반 타임스탬프 검색
- NoteArea.tsx:수동이동시우선순위재설정 수동 이동시 우선순위 재설정

=== 3. 댓글 시스템 기능별 코드 위치 ===

📝 댓글 시스템 (미연결 상태):
- CommentModal.tsx:전체컴포넌트 댓글 조회, 필터링, 정렬
- CommentInputModal.tsx:전체컴포넌트 댓글 작성, 별점 선택
- TestSharePage.tsx:전체컴포넌트 댓글 시스템 테스트
- CommentModal.tsx:getAverageRatingByRange 별점 범위별 평균 점수 계산
- CommentInputModal.tsx:renderNewRatingSelector 가로 배치 별점 선택 UI
→ 연결 작업 필요: App.tsx에 import하여 메인 앱에서 사용 가능하게 해야 함