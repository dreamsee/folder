# Claude Code 작업 지침

작업내역을 저장할 때는 마크다운 형식이나 이모티콘을 사용하지 말고 일반 텍스트 형식으로 작성해주세요.

예시:
- 마크다운 사용 금지: ## 제목, ### 소제목, **굵은글씨**, - 목록 등
- 이모티콘 사용 금지: 🎯, ✅, 🔧, 📋 등
- 일반 텍스트로만 작성: 제목, 내용, 목록은 단순 텍스트와 들여쓰기로 표현

작업내역 저장 형식:

작업 날짜: YYYY-MM-DD
작업명: 간략한 기능 요약

구현 내용:
한 줄 요약 설명

수정 파일 및 변경 내용:

1. 파일경로/파일명.확장자
   
   삭제됨:
   실제 삭제된 코드 블록 전체 내용 작성
   
   추가됨:
   실제 추가된 코드 블록 전체 내용 작성
   
   수정됨:
   변경 전 코드 블록 → 변경 후 코드 블록

2. 다른파일경로/파일명.확장자
   
   (같은 형식으로 반복)

주의사항:
- 삭제됨, 추가됨, 수정됨 항목에는 실제 코드를 그대로 기록해야 함
- 설명이나 요약이 아닌 변경된 코드 자체를 작성
- 파일에서 실제로 변경된 코드 블록을 정확히 복사하여 저장
- 함수나 컴포넌트 전체가 변경된 경우 전체 코드 포함

데이터 구조:
새로 추가되거나 변경된 데이터 스키마 설명
localStorage나 상태 구조 변경사항

삭제된 기능:
- 제거된 기능 목록

추가된 기능:
- 새로 추가된 기능 목록

작업내역 저장 경로:
/data/data/com.termux/files/home/folder/유튜브노트/작업내역/

프로젝트 구조 및 시스템 이해:
기능을 찾거나 파일 위치가 궁금할 때는 먼저 '/data/data/com.termux/files/home/folder/유튜브노트/주요파일위치.txt' 파일을 참조하세요.
새로운 기능이나 컴포넌트가 추가되면 반드시 해당 파일을 업데이트해주세요.

문서 파일 업데이트 가이드:

주요파일위치.txt 업데이트:
- 목적: 파일 위치와 기능별 코드 매핑 관리
- 내용: 파일 분류, 기능별 코드 위치, 컴포넌트 관계
- 변경사항은 포함하지 않음 (변경사항.txt로 분리)

변경사항.txt 업데이트:
- 목적: 날짜별 변경 이력 관리
- 내용: 날짜, 변경된 파일명, 구체적 변경 내용
- 최신 날짜가 위에 오도록 내림차순 정렬

위치추적파일 업데이트 가이드:

목적:
1. 검색 시간 단축 - 기능 찾으려고 파일 뒤지지 않고 바로 줄 번호로 이동
2. 연관 코드 파악 - 한 기능 수정할 때 영향받는 다른 코드 위치들 한눈에 보기
3. 중복 방지 - 같은 로직이 여러 곳에 있는지 미리 확인

구조:
1. 기본 파일 분류
   - 카테고리별 파일 목록과 주요 역할
   - 예: "- client/src/components/NoteArea.tsx: 노트 영역 및 재생 컨트롤"

2. 기능별 코드 위치 매핑 (핵심)
   - 기능명과 관련된 모든 코드의 정확한 위치 (파일명:줄번호 또는 함수명)
   - 연관 코드들의 의존관계 및 수정 시 주의사항
   - 예시:
   ```
   타임스탬프 자동 실행:
   - NoteArea.tsx:362-380 타임스탬프 진입 감지 로직
   - NoteArea.tsx:855 addTimestamp() 도장 버튼 함수
   - NoteArea.tsx:1184-1208 더블클릭 핸들러
   - YouTubePlayer.tsx:67-89 커스텀 진행바 렌더링
   - HomePage.tsx:45 timestamps 상태 관리
   → 수정 시 주의: NoteArea 파싱 형식 변경하면 YouTubePlayer 데이터 구조도 확인
   ```

작성 원칙:
- 함수명이나 줄 번호를 정확히 기록
- 연관된 코드들의 위치를 모두 나열
- 수정 시 함께 확인해야 할 코드 위치 명시
- 중복 로직이 있는 경우 모든 위치 기록하여 통합 검토 가능하게 함

업데이트 시점:
- 새 기능 추가 시: 주요파일위치.txt에 코드 위치 추가, 변경사항.txt에 날짜별 기록
- 코드 이동이나 리팩토링 시: 주요파일위치.txt 줄 번호 업데이트
- 함수 분리나 통합 시: 위치 매핑 재정리

중요: 타임스탬프 관련 작업을 시작하기 전에 반드시 다음 파일들을 읽고 이해한 후 작업하세요:
1. '/data/data/com.termux/files/home/folder/유튜브노트/주요파일위치.txt' - 파일 위치 및 시스템 구조
2. '/data/data/com.termux/files/home/folder/유튜브노트/작동로직.txt' - 타임스탬프 시스템 완전 작동 원리

작동로직.txt 파일에는 다음이 포함되어 있습니다:
- 6단계 파이프라인 (파싱 → 감지 → 진입 → 이탈 → 자동점프 → 사용자설정관리)
- 타임스탬프 형식 및 정규식 패턴
- 우선순위 시스템 및 순차 실행 로직
- 더블클릭 작동 방식 (시작/종료시간 구분)
- 액션 타입별 상세 동작 (일반/정지/자동점프)
- 편집모드 vs 도장버튼 차이점
- 자동 파싱 및 실시간 업데이트 시스템
- 커스텀바 하이라이트 및 설정 복원 체계
- 디버깅 및 핵심 주의사항

이 문서들을 통해 기존 시스템을 파괴하지 않고 새로운 기능을 올바르게 통합할 수 있습니다.

프로젝트 명칭 별칭:
- 유브: /data/data/com.termux/files/home/folder/유튜브노트_브랜치 프로젝트
- 유노: /data/data/com.termux/files/home/folder/유튜브노트 프로젝트 (참고용)
- 테탐: TestTimestampPage.tsx (http://localhost:5174/test-timestamp)

파일 명칭 별칭:
- 주요파일위치.txt는 다음과 같이 불릴 수 있습니다:
  * 위치파일, 위치추적파일, 파일위치, 파일추적위치
  * 구조파일, 구조추적파일, 파일구조, 파일매핑
  * 위치매핑, 위치정보, 파일정보 등
- 이 모든 명칭은 '/data/data/com.termux/files/home/folder/유튜브노트/주요파일위치.txt' 파일을 가리킵니다.
- 작동로직.txt는 다음과 같이 불릴 수 있습니다:
  * 로직파일, 작동파일, 시스템로직, 타임스탬프로직
  * 작동원리, 동작로직, 시스템동작, 로직문서
  * 로직추적, 로직추적파일 등
- 이 모든 명칭은 '/data/data/com.termux/files/home/folder/유튜브노트/작동로직.txt' 파일을 가리킵니다.

테스트 파일 관리 방침:

테스트 목적으로 생성된 간소화된 컴포넌트들은 삭제하지 말고 참고용으로 보관합니다.
이러한 파일들은 향후 디버깅이나 기능 개발 시 기본 로직을 확인하는 용도로 사용됩니다.

예시:
- SimpleNoteArea.tsx: 타임스탬프 기본 로직 참고용 컴포넌트
- 원본 파일 수정 시 테스트 파일의 검증된 로직을 참고하여 적용
- 파일 상단에 참고용임을 명시하는 주석 추가

테스트 파일 명명 규칙:
- Simple[원본파일명].tsx 형태로 작성
- 파일 상단에 용도와 참고할 로직에 대한 설명 주석 포함

코드 수정시 설명 방식 지침:

코드를 수정할 때는 반드시 다음과 같이 설명하면서 수정해주세요:

1. 기능 설명은 간단히 요약
2. 코드 구조와 로직을 상세히 설명
3. 사용된 기술과 변경 이유 명시

예시:
"문제점: 현재 colorMap 객체에서 RGB 값이 어두움
수정 방향: backgroundColor를 rgba() 함수로 변경해서 알파 채널 추가
코드 변경: 16진수 #10D876를 rgba(16, 216, 118, 0.8)로 변환하여 80% 불투명도 적용"

사용자 요청 처리 규칙:

사용자가 수정사항이나 아이디어를 제안할 때:
1. "수정", "시작", "구현", "진행", "해줘", "만들어줘" 등의 명령어가 없는 경우
2. 반드시 "이해한 내용:" 또는 "이해한거 보고!" 형태로 먼저 이해 내용 확인
3. 사용자 승인 후에만 작업 시작
4. 즉시 구현하지 말고 이해 검증부터 할 것

작업 시작 조건 (다음 표현이 있을 때만 작업 시작):
- "수정해줘", "시작해", "구현해", "진행해", "만들어줘"
- "이 방향으로 수정할까요?" → 사용자가 "응", "맞아", "그래" 등으로 승인
- 명확한 작업 지시어가 포함된 경우

예시 1 (이해 확인 필요):
사용자: "별 크기가 달라서 불편해"
assistant: "이해한 내용: 왼쪽 선택용 별과 오른쪽 결과 별의 크기가 달라서 일관성이 없어 보임. 모든 별을 동일한 크기로 통일하면 되겠네요. 이 방향으로 수정할까요?"

예시 2 (즉시 작업):
사용자: "별 크기 통일해서 수정해줘"
assistant: "별 크기를 통일하도록 수정하겠습니다." (바로 작업 시작)

중요: 사용자가 단순히 문제점이나 아이디어만 언급하고 명령어가 없다면 반드시 이해 확인부터 해야 함

코드 주석 작성 지침:

코드를 작성하거나 수정할 때는 반드시 상세한 주석을 포함해주세요.

주석 작성 원칙:
1. 모든 주요 로직에는 설명 주석 필수
2. 복잡한 조건문이나 계산식에는 상세한 설명 추가
3. 함수나 메서드의 목적과 매개변수, 반환값 설명
4. 버그 수정이나 특수한 처리를 하는 경우 이유 명시
5. TODO나 FIXME 같은 태그를 활용하여 향후 개선점 표시
6. 기능 추가시 기존 기능과 새 기능을 모두 포함하여 주석 작성

기능 누적 주석 작성법:
- 기존: {/* 별 선택 영역 (재선택 가능) */}
- 기능 추가 후: {/* 별 선택 영역 (재선택 가능 & 고정 위치) */}
- 목적: 해당 코드가 수행하는 모든 기능을 한눈에 파악 가능
- 원칙: 기존 기능 + & + 새 기능 형태로 누적 작성

중요 코드 주석 규칙 (절대 준수):
1. 핵심 로직 변경 금지 주석
   - "절대 변경 금지:" 로 시작
   - 변경시 발생하는 문제 명시
   - 예: "// 절대 변경 금지: clickedIndex로 설정하면 자동 감지가 못 찾아서 이탈 로직 실행됨"

2. 중요 동작 설명 주석
   - "중요:" 로 시작
   - 해당 코드가 왜 필요한지 설명
   - 예: "// 중요: 더블클릭시 타임스탬프 설정을 즉시 적용해야 함"

3. 로직 연관성 주석
   - 다른 코드와의 연관성 명시
   - 변경시 함께 확인해야 할 부분 표시
   - 예: "// 자동 감지는 lastActiveIndex + 1부터 체크하므로 더블클릭시 clickedIndex - 1로 설정"

4. 버그 방지 주석
   - 과거 버그 경험을 바탕으로 작성
   - 흔히 발생하는 실수 방지
   - 예: "// 이것도 중요: UI와 플레이어 상태를 일치시켜야 함"

주석 스타일:
- 한 줄 주석: // 설명 내용
- 여러 줄 주석: /* 설명 내용 */
- 함수 설명: /** JSDoc 스타일 사용 */

주석 작성 예시:

// 타임스탬프 더블클릭 처리 함수
// 시작시간 클릭: activeTimestamp 설정하여 자동 실행 방지
// 종료시간 클릭: activeTimestamp 미설정으로 자동 이탈 처리
const handleTimestampClick = (e) => {
  // 더블클릭만 처리 (단일 클릭 무시)
  if (e.detail !== 2) return;

  // 클릭 위치 계산 - 타임스탬프 내 어느 부분을 클릭했는지 판별
  const dashPos = timestamp.indexOf('-');
  const isEndTimeClick = clickPosition > (timestampStart + dashPos);

  if (isEndTimeClick) {
    // 종료시간 클릭: activeTimestamp를 설정하지 않음
    // 이유: 타임스탬프 구간 밖이므로 자동 이탈 로직이 작동하여 기본값 복원
    console.log('종료시간 클릭 - 자동 이탈 대기');
  } else {
    // 시작시간 클릭: activeTimestamp 설정
    // 이유: 중복 실행 방지 및 타임스탬프 설정 적용
    setActiveTimestamp(timestamp);
  }
};

주석이 필요한 상황:
- 비즈니스 로직이 복잡한 경우
- 알고리즘이나 수식을 사용하는 경우
- 외부 API나 라이브러리를 사용하는 경우
- 성능 최적화나 메모리 관리를 하는 경우
- 예외 처리나 에러 핸들링을 하는 경우
- 하드코딩된 값이나 매직 넘버를 사용하는 경우

주석 작성 시 피해야 할 것:
- 코드를 그대로 설명하는 불필요한 주석 (예: i++; // i를 1 증가)
- 오래된 주석이나 잘못된 정보를 담은 주석
- 주석으로 코드를 비활성화하는 것 (삭제하거나 버전 관리 활용)

이 지침을 따라 코드의 가독성과 유지보수성을 높여주세요.

파일 편집 신중성 지침:

파일을 편집할 때는 주석 작성과 동일한 수준의 신중함을 적용해야 합니다.

파일 편집 원칙:
1. Edit 도구 사용 시 old_string을 최소한으로 정확히 지정
2. 수정하려는 부분과 관련 없는 코드는 절대 포함하지 않음
3. 큰 변경이 필요한 경우 단계별로 나누어 작업
4. 변경 전 해당 섹션의 내용을 정확히 확인 후 편집

편집 시 절대 금지 사항:
- 타겟 코드와 무관한 내용을 old_string에 포함하는 것
- 확인하지 않고 큰 블록을 통째로 교체하는 것
- 한 번에 여러 기능을 동시에 수정하는 것
- 기존 기능 문서를 새 기능 추가하면서 삭제하는 것

예시 (올바른 편집):
- 타임스탬프 테스트 섹션만 추가할 때: 해당 섹션만 정확히 타겟팅
- 기존 댓글 시스템 내용은 건드리지 않음
- 새 내용을 기존 구조에 맞게 추가

예시 (잘못된 편집):
- 댓글 시스템과 무관한 타임스탬프 작업인데 댓글 관련 내용까지 old_string에 포함
- 전체 문서를 통째로 바꾸려는 시도
- 관련 없는 섹션들을 함께 묶어서 편집

중요: 파일 편집은 외과 수술과 같아야 함
- 정확한 부위만 최소 침습으로 수정
- 주변 조직(코드)에 손상 없이 작업
- 수술 전 정확한 진단(코드 확인) 필수

깃허브 업데이트 지침:

사용자가 "깃허브 업데이트" 요청 시, 반드시 유튜브노트 폴더만 선택적으로 커밋/푸시해야 합니다.

올바른 방법:
```bash
# 유튜브노트 폴더의 변경사항만 선택적으로 추가
git add 유튜브노트/

# 커밋 (유튜브노트 변경사항만)
git commit -m "커밋 메시지"

# 푸시 (다른 폴더는 건드리지 않음)
git push
```

절대 금지 사항:
- git add . 또는 git add -A 사용 금지
- 다른 폴더 삭제나 수정 절대 금지
- GitHub에 있는 다른 프로젝트 폴더들 건드리지 말 것

이유:
- 로컬에는 유튜브노트만 있지만 GitHub에는 여러 프로젝트가 있음
- 다른 폴더들은 컴퓨터에서 관리함
- 여기서는 유튜브노트만 작업하고 그것만 업데이트