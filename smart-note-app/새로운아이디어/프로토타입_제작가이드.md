# ë…¸íŠ¸ ì •ë¹„ì†Œ í”„ë¡œí† íƒ€ì… ì œì‘ ê°€ì´ë“œ

## ğŸ¯ ì‹œí—˜ìš© ë¯¸ë‹ˆ ë²„ì „ êµ¬ì„±

### Phase 1: ê¸°ë³¸ ì±„íŒ… + íŒŒì¼ ìˆ˜ì • ì‹œìŠ¤í…œ

---

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

### í”„ë¡ íŠ¸ì—”ë“œ
- **React + TypeScript**: UI êµ¬ì„±
- **Monaco Editor**: ì½”ë“œ í¸ì§‘ê¸° (VS Codeì™€ ê°™ì€ ì—”ì§„)
- **Socket.io**: ì‹¤ì‹œê°„ í†µì‹ 
- **Iframe**: ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°

### ë°±ì—”ë“œ  
- **Node.js + Express**: ì„œë²„
- **Anthropic API**: Claude í†µí•©
- **fs (íŒŒì¼ì‹œìŠ¤í…œ)**: íŒŒì¼ ì½ê¸°/ì“°ê¸°
- **Chokidar**: íŒŒì¼ ë³€ê²½ ê°ì§€

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
note-garage-prototype/
â”œâ”€â”€ client/                 # React í”„ë¡ íŠ¸ì—”ë“œ
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatPanel.tsx      # Claude ì±„íŒ…
â”‚   â”‚   â”‚   â”œâ”€â”€ FileEditor.tsx     # íŒŒì¼ í¸ì§‘ê¸°
â”‚   â”‚   â”‚   â”œâ”€â”€ PreviewPanel.tsx   # ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°
â”‚   â”‚   â”‚   â””â”€â”€ GarageInterface.tsx # ë©”ì¸ UI
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ claudeAPI.ts       # Claude API í†µì‹ 
â”‚   â”‚   â”‚   â””â”€â”€ fileSystem.ts      # íŒŒì¼ ì‘ì—…
â”‚   â”‚   â””â”€â”€ App.tsx
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ server/                 # Node.js ë°±ì—”ë“œ
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ claude.js              # Claude API í”„ë¡ì‹œ
â”‚   â”‚   â”œâ”€â”€ files.js               # íŒŒì¼ ì‹œìŠ¤í…œ API
â”‚   â”‚   â””â”€â”€ preview.js             # ë¯¸ë¦¬ë³´ê¸° ì„œë²„
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ claudeService.js       # Claude í†µí•© ë¡œì§
â”‚   â”‚   â””â”€â”€ fileWatcher.js         # íŒŒì¼ ë³€ê²½ ê°ì§€
â”‚   â”œâ”€â”€ public/                    # ì •ì  íŒŒì¼ ì„œë¹™
â”‚   â””â”€â”€ server.js
â”‚
â””â”€â”€ workspace/              # ì‘ì—… ê³µê°„ (ì‚¬ìš©ì íŒŒì¼ë“¤)
    â”œâ”€â”€ current-note/
    â”‚   â”œâ”€â”€ index.html
    â”‚   â”œâ”€â”€ style.css
    â”‚   â””â”€â”€ script.js
    â””â”€â”€ backups/
```

---

## ğŸ”§ í•µì‹¬ êµ¬í˜„ ì½”ë“œ

### 1. Claude API í†µí•© (ì„œë²„)
```javascript
// server/services/claudeService.js
const Anthropic = require('@anthropic-ai/sdk');

class ClaudeService {
  constructor() {
    this.anthropic = new Anthropic({
      apiKey: process.env.ANTHROPIC_API_KEY,
    });
  }

  async processUserRequest(message, currentFiles) {
    // í˜„ì¬ íŒŒì¼ë“¤ì„ Claudeì—ê²Œ ë³´ì—¬ì¤Œ
    const context = this.buildFileContext(currentFiles);
    
    const response = await this.anthropic.messages.create({
      model: 'claude-3-sonnet-20240229',
      max_tokens: 4000,
      system: `ë‹¹ì‹ ì€ ë…¸íŠ¸ ì •ë¹„ì†Œì˜ ì „ë¬¸ AIì…ë‹ˆë‹¤. 
               í˜„ì¬ íŒŒì¼ë“¤ì„ ë¶„ì„í•˜ê³  ì‚¬ìš©ì ìš”ì²­ì— ë”°ë¼ ìˆ˜ì •í•´ì£¼ì„¸ìš”.
               
               ì‘ë‹µ í˜•ì‹:
               1. ì„¤ëª…: ë¬´ì—‡ì„ í• ì§€ ì„¤ëª…
               2. íŒŒì¼ ë³€ê²½ì‚¬í•­: JSON í˜•íƒœë¡œ ë°˜í™˜
               
               í˜„ì¬ íŒŒì¼ ìƒíƒœ:
               ${context}`,
      messages: [{
        role: 'user',
        content: message
      }]
    });

    return this.parseClaudeResponse(response.content[0].text);
  }

  buildFileContext(files) {
    return files.map(file => 
      `íŒŒì¼: ${file.path}\në‚´ìš©:\n${file.content}\n---`
    ).join('\n');
  }

  parseClaudeResponse(response) {
    // Claudeì˜ ì‘ë‹µì„ íŒŒì‹±í•´ì„œ ì‹¤ì œ íŒŒì¼ ë³€ê²½ì‚¬í•­ ì¶”ì¶œ
    const lines = response.split('\n');
    let explanation = '';
    let fileChanges = [];
    
    // ê°„ë‹¨í•œ íŒŒì‹± ë¡œì§ (ì‹¤ì œë¡œëŠ” ë” ì •êµí•´ì•¼ í•¨)
    let inFileChange = false;
    let currentFileChange = {};
    
    for (const line of lines) {
      if (line.startsWith('íŒŒì¼:')) {
        if (inFileChange && currentFileChange.path) {
          fileChanges.push(currentFileChange);
        }
        inFileChange = true;
        currentFileChange = {
          path: line.replace('íŒŒì¼:', '').trim(),
          content: ''
        };
      } else if (inFileChange) {
        currentFileChange.content += line + '\n';
      } else {
        explanation += line + '\n';
      }
    }
    
    if (inFileChange && currentFileChange.path) {
      fileChanges.push(currentFileChange);
    }
    
    return {
      explanation: explanation.trim(),
      fileChanges
    };
  }
}

module.exports = ClaudeService;
```

### 2. ì‹¤ì‹œê°„ íŒŒì¼ ì‹œìŠ¤í…œ (ì„œë²„)
```javascript
// server/routes/files.js
const express = require('express');
const fs = require('fs').promises;
const path = require('path');
const chokidar = require('chokidar');

const router = express.Router();
const WORKSPACE_DIR = path.join(__dirname, '../workspace/current-note');

// íŒŒì¼ ì½ê¸°
router.get('/read/:filename', async (req, res) => {
  try {
    const filepath = path.join(WORKSPACE_DIR, req.params.filename);
    const content = await fs.readFile(filepath, 'utf-8');
    res.json({ success: true, content, filename: req.params.filename });
  } catch (error) {
    res.status(404).json({ success: false, error: error.message });
  }
});

// íŒŒì¼ ì“°ê¸°
router.post('/write/:filename', async (req, res) => {
  try {
    const filepath = path.join(WORKSPACE_DIR, req.params.filename);
    await fs.writeFile(filepath, req.body.content, 'utf-8');
    res.json({ success: true, message: 'File updated' });
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
});

// ëª¨ë“  íŒŒì¼ ëª©ë¡
router.get('/list', async (req, res) => {
  try {
    const files = await fs.readdir(WORKSPACE_DIR);
    const fileContents = await Promise.all(
      files.map(async (filename) => {
        const filepath = path.join(WORKSPACE_DIR, filename);
        const content = await fs.readFile(filepath, 'utf-8');
        return { path: filename, content };
      })
    );
    res.json({ success: true, files: fileContents });
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
});

module.exports = router;
```

### 3. ì±„íŒ… ì¸í„°í˜ì´ìŠ¤ (í”„ë¡ íŠ¸ì—”ë“œ)
```typescript
// client/src/components/ChatPanel.tsx
import React, { useState, useEffect } from 'react';
import { sendToClaude, getFiles, updateFile } from '../services/claudeAPI';

interface Message {
  role: 'user' | 'claude';
  content: string;
  timestamp: Date;
}

const ChatPanel: React.FC = () => {
  const [messages, setMessages] = useState<Message[]>([]);
  const [input, setInput] = useState('');
  const [loading, setLoading] = useState(false);

  const sendMessage = async () => {
    if (!input.trim()) return;
    
    const userMessage: Message = {
      role: 'user',
      content: input,
      timestamp: new Date()
    };
    
    setMessages(prev => [...prev, userMessage]);
    setInput('');
    setLoading(true);

    try {
      // í˜„ì¬ íŒŒì¼ë“¤ ê°€ì ¸ì˜¤ê¸°
      const filesResponse = await getFiles();
      
      // Claudeì—ê²Œ ìš”ì²­ ë³´ë‚´ê¸°
      const claudeResponse = await sendToCloud(input, filesResponse.data.files);
      
      const claudeMessage: Message = {
        role: 'claude',
        content: claudeResponse.explanation,
        timestamp: new Date()
      };
      
      setMessages(prev => [...prev, claudeMessage]);
      
      // íŒŒì¼ ë³€ê²½ì‚¬í•­ ì ìš©
      for (const change of claudeResponse.fileChanges) {
        await updateFile(change.path, change.content);
      }
      
    } catch (error) {
      console.error('Error:', error);
      const errorMessage: Message = {
        role: 'claude',
        content: 'ì£„ì†¡í•©ë‹ˆë‹¤. ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.',
        timestamp: new Date()
      };
      setMessages(prev => [...prev, errorMessage]);
    }
    
    setLoading(false);
  };

  return (
    <div className="chat-panel">
      <div className="messages">
        {messages.map((message, index) => (
          <div key={index} className={`message ${message.role}`}>
            <div className="message-content">{message.content}</div>
            <div className="message-time">
              {message.timestamp.toLocaleTimeString()}
            </div>
          </div>
        ))}
        {loading && (
          <div className="message claude loading">
            <div className="message-content">Claudeê°€ ì‘ì—… ì¤‘ì…ë‹ˆë‹¤...</div>
          </div>
        )}
      </div>
      
      <div className="input-area">
        <input
          type="text"
          value={input}
          onChange={(e) => setInput(e.target.value)}
          onKeyPress={(e) => e.key === 'Enter' && sendMessage()}
          placeholder="Claudeì—ê²Œ ë…¸íŠ¸ ìˆ˜ì • ìš”ì²­ì„ í•´ë³´ì„¸ìš”..."
          disabled={loading}
        />
        <button onClick={sendMessage} disabled={loading}>
          ì „ì†¡
        </button>
      </div>
    </div>
  );
};

export default ChatPanel;
```

### 4. ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸° (í”„ë¡ íŠ¸ì—”ë“œ)
```typescript
// client/src/components/PreviewPanel.tsx
import React, { useEffect, useRef, useState } from 'react';
import { getFiles } from '../services/claudeAPI';

const PreviewPanel: React.FC = () => {
  const iframeRef = useRef<HTMLIFrameElement>(null);
  const [previewUrl, setPreviewUrl] = useState('');

  useEffect(() => {
    // íŒŒì¼ ë³€ê²½ ê°ì§€ ë° ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
    const interval = setInterval(async () => {
      try {
        const response = await getFiles();
        updatePreview(response.data.files);
      } catch (error) {
        console.error('Preview update error:', error);
      }
    }, 1000); // 1ì´ˆë§ˆë‹¤ ì²´í¬

    return () => clearInterval(interval);
  }, []);

  const updatePreview = (files: any[]) => {
    // HTML íŒŒì¼ ì°¾ê¸°
    const htmlFile = files.find(f => f.path.endsWith('.html'));
    if (htmlFile && iframeRef.current) {
      // Blob URL ìƒì„±í•´ì„œ iframeì— ë¡œë“œ
      const blob = new Blob([htmlFile.content], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      
      if (previewUrl) {
        URL.revokeObjectURL(previewUrl);
      }
      
      setPreviewUrl(url);
      iframeRef.current.src = url;
    }
  };

  return (
    <div className="preview-panel">
      <div className="preview-header">
        <h3>ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°</h3>
        <button onClick={() => iframeRef.current?.contentWindow?.location.reload()}>
          ìƒˆë¡œê³ ì¹¨
        </button>
      </div>
      
      <iframe
        ref={iframeRef}
        className="preview-iframe"
        title="Live Preview"
        sandbox="allow-scripts allow-same-origin"
      />
    </div>
  );
};

export default PreviewPanel;
```

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### 1. í™˜ê²½ ì„¤ì •
```bash
# í”„ë¡œì íŠ¸ ìƒì„±
mkdir note-garage-prototype
cd note-garage-prototype

# ì„œë²„ ì„¤ì •
mkdir server && cd server
npm init -y
npm install express anthropic @anthropic-ai/sdk chokidar cors dotenv
touch .env

# .env íŒŒì¼ì— API í‚¤ ì¶”ê°€
echo "ANTHROPIC_API_KEY=your_claude_api_key_here" >> .env

# í´ë¼ì´ì–¸íŠ¸ ì„¤ì •  
cd .. && npx create-react-app client --template typescript
cd client
npm install axios socket.io-client monaco-editor @monaco-editor/react
```

### 2. í…ŒìŠ¤íŠ¸ íŒŒì¼ ì¤€ë¹„
```bash
# ì‘ì—…ê³µê°„ ìƒì„±
mkdir -p workspace/current-note

# ê°„ë‹¨í•œ HTML íŒŒì¼ ìƒì„±
cat > workspace/current-note/index.html << 'EOF'
<!DOCTYPE html>
<html>
<head>
    <title>My Note</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>ë‚´ ë…¸íŠ¸</h1>
        <p>ì—¬ê¸°ëŠ” ë‚´ìš©ì´ ë“¤ì–´ê°€ëŠ” ê³³ì…ë‹ˆë‹¤.</p>
        <button onclick="alert('ì•ˆë…•!')">í´ë¦­í•´ë³´ì„¸ìš”</button>
    </div>
    <script src="script.js"></script>
</body>
</html>
EOF

cat > workspace/current-note/style.css << 'EOF'
body {
    font-family: Arial, sans-serif;
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
    background-color: #f5f5f5;
}

.container {
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

h1 {
    color: #333;
    text-align: center;
}

button {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
}
EOF

touch workspace/current-note/script.js
```

### 3. ì„œë²„ ì‹¤í–‰
```bash
# ì„œë²„ ë””ë ‰í† ë¦¬ì—ì„œ
node server.js
```

### 4. í´ë¼ì´ì–¸íŠ¸ ì‹¤í–‰  
```bash
# í´ë¼ì´ì–¸íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ
npm start
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ìƒ‰ìƒ ë³€ê²½
```
ì‚¬ìš©ì: "ë°°ê²½ìƒ‰ì„ íŒŒë€ìƒ‰ìœ¼ë¡œ ë°”ê¿”ì¤˜"
Claude: "ë°°ê²½ìƒ‰ì„ íŒŒë€ìƒ‰ìœ¼ë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤"
â†’ style.cssì˜ background-colorê°€ ìë™ ë³€ê²½
â†’ ë¯¸ë¦¬ë³´ê¸°ì—ì„œ ì¦‰ì‹œ í™•ì¸ ê°€ëŠ¥
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: í…ìŠ¤íŠ¸ ìˆ˜ì •
```
ì‚¬ìš©ì: "ì œëª©ì„ 'ë©‹ì§„ ë…¸íŠ¸'ë¡œ ë°”ê¿”ì¤˜"  
Claude: "ì œëª©ì„ 'ë©‹ì§„ ë…¸íŠ¸'ë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤"
â†’ index.htmlì˜ h1 íƒœê·¸ ë‚´ìš© ë³€ê²½
â†’ ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: ë²„íŠ¼ ì¶”ê°€
```
ì‚¬ìš©ì: "ìƒˆë¡œìš´ ë²„íŠ¼ì„ í•˜ë‚˜ ë” ì¶”ê°€í•´ì¤˜"
Claude: "ìƒˆ ë²„íŠ¼ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤"  
â†’ HTMLì— ìƒˆ ë²„íŠ¼ ìš”ì†Œ ì¶”ê°€
â†’ CSSì— ìŠ¤íƒ€ì¼ ì¶”ê°€
â†’ ë¯¸ë¦¬ë³´ê¸°ì—ì„œ ì¦‰ì‹œ í™•ì¸
```

---

## âš¡ ë°œì „ ë°©í–¥

### Phase 2: ê³ ê¸‰ ê¸°ëŠ¥
- **ë“œë˜ê·¸ ì•¤ ë“œë¡­**: ìš”ì†Œ ìœ„ì¹˜ ì¡°ì •
- **ë ˆì´ì–´ ê´€ë¦¬**: Z-index ì‹œê°ì  ê´€ë¦¬  
- **ì•„ì´ì½˜ ë¼ì´ë¸ŒëŸ¬ë¦¬**: ê²€ìƒ‰ ê°€ëŠ¥í•œ ì•„ì´ì½˜ë“¤

### Phase 3: AI ê³ ë„í™”
- **ì´ë¯¸ì§€ ì¸ì‹**: ìŠ¤í¬ë¦°ìƒ· ê¸°ë°˜ ìˆ˜ì • ìš”ì²­
- **ë””ìì¸ ì œì•ˆ**: "ë” ì˜ˆì˜ê²Œ í•´ì¤˜" ê°™ì€ ì¶”ìƒì  ìš”ì²­
- **ì„±ëŠ¥ ìµœì í™”**: ìë™ ì½”ë“œ ìµœì í™”

---

## ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸

1. **ì‹œì‘ì€ ê°„ë‹¨í•˜ê²Œ**: ì±„íŒ… + íŒŒì¼ ìˆ˜ì • + ë¯¸ë¦¬ë³´ê¸°
2. **ì ì§„ì  ê°œì„ **: ê¸°ëŠ¥ì„ í•˜ë‚˜ì”© ì¶”ê°€
3. **ì‹¤ì œ í…ŒìŠ¤íŠ¸**: ê°„ë‹¨í•œ HTML/CSSë¡œ ì‹œì‘
4. **ì‚¬ìš©ì í”¼ë“œë°±**: ì‹¤ì œ ì‚¬ìš©í•´ë³´ë©´ì„œ ê°œì„ 

ì´ í”„ë¡œí† íƒ€ì…ìœ¼ë¡œ **"AIì™€ í•¨ê»˜í•˜ëŠ” ì‹¤ì‹œê°„ í¸ì§‘"**ì˜ ê°€ëŠ¥ì„±ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸš€