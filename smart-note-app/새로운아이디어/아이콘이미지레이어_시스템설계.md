# 아이콘·이미지·레이어 통합 관리 시스템

## 🎯 핵심 기능들

### 1. 아이콘 검색 & 삽입 시스템
### 2. 이미지 영역 생성 & 관리
### 3. 레이어(Z-Index) 시각적 관리

---

## 🎨 아이콘 시스템 구현

### 아이콘 라이브러리 통합
```typescript
import { 
  Clock, Timer, Calendar, User, Settings, 
  Heart, Star, Search, Bell, Mail 
} from 'lucide-react';

interface 아이콘데이터 {
  이름: string;
  컴포넌트: React.ComponentType;
  태그들: string[];
  카테고리: string;
  미리보기: string;
}

const 아이콘라이브러리 = {
  시계관련: [
    { 이름: 'Clock', 컴포넌트: Clock, 태그들: ['시계', '시간', 'time'], 미리보기: '🕐' },
    { 이름: 'Timer', 컴포넌트: Timer, 태그들: ['타이머', '알람'], 미리보기: '⏲️' }
  ],
  사용자관련: [
    { 이름: 'User', 컴포넌트: User, 태그들: ['사용자', '프로필'], 미리보기: '👤' },
    { 이름: 'Settings', 컴포넌트: Settings, 태그들: ['설정', '옵션'], 미리보기: '⚙️' }
  ]
  // ... 더 많은 카테고리
};

class 아이콘검색엔진 {
  검색(키워드: string): 아이콘데이터[] {
    return 아이콘라이브러리.전체.filter(아이콘 => 
      아이콘.태그들.some(태그 => 태그.includes(키워드)) ||
      아이콘.이름.toLowerCase().includes(키워드.toLowerCase())
    );
  }
  
  인기아이콘추천(): 아이콘데이터[] {
    return ['Clock', 'User', 'Settings', 'Heart', 'Star'].map(name => 
      this.아이콘찾기(name)
    );
  }
}
```

### AI 아이콘 대화 시스템
```typescript
const 아이콘AI대화 = {
  async 키워드처리(사용자입력: string): Promise<아이콘UI> {
    if (사용자입력.includes('아이콘')) {
      const 키워드 = this.키워드추출(사용자입력); // "시계 아이콘" → "시계"
      const 검색결과 = 아이콘검색엔진.검색(키워드);
      
      return {
        메시지: `'${키워드}' 관련 아이콘들을 찾았어요! 원하는 것을 선택해주세요.`,
        아이콘그리드: this.그리드생성(검색결과),
        추가옵션: ['크기 조정', '색상 변경', '다른 키워드 검색']
      };
    }
  },
  
  그리드생성(아이콘들: 아이콘데이터[]): JSX.Element {
    return (
      <div className="아이콘-그리드" style={{ 
        display: 'grid', 
        gridTemplateColumns: 'repeat(5, 1fr)', 
        gap: '12px',
        padding: '16px'
      }}>
        {아이콘들.map(아이콘 => (
          <div 
            key={아이콘.이름}
            className="아이콘-선택지" 
            onClick={() => this.아이콘선택(아이콘)}
            style={{
              padding: '12px',
              border: '1px solid #ddd',
              borderRadius: '8px',
              cursor: 'pointer',
              textAlign: 'center'
            }}
          >
            <아이콘.컴포넌트 size={24} />
            <div style={{ fontSize: '12px', marginTop: '4px' }}>
              {아이콘.이름}
            </div>
          </div>
        ))}
      </div>
    );
  }
};
```

---

## 🖼️ 이미지 영역 생성 시스템

### 드래그로 영역 지정
```typescript
class 이미지영역생성기 {
  드래그모드활성화(): void {
    document.addEventListener('mousedown', this.드래그시작);
    document.body.style.cursor = 'crosshair';
    this.가이드메시지표시('드래그해서 이미지 영역을 만들어보세요');
  }
  
  드래그시작(e: MouseEvent): void {
    this.시작점 = { x: e.clientX, y: e.clientY };
    this.드래그사각형생성();
    
    document.addEventListener('mousemove', this.드래그중);
    document.addEventListener('mouseup', this.드래그종료);
  }
  
  드래그중(e: MouseEvent): void {
    const 현재점 = { x: e.clientX, y: e.clientY };
    const 넓이 = Math.abs(현재점.x - this.시작점.x);
    const 높이 = Math.abs(현재점.y - this.시작점.y);
    
    this.드래그사각형.style.width = `${넓이}px`;
    this.드래그사각형.style.height = `${높이}px`;
    this.실시간크기표시(넓이, 높이);
  }
  
  드래그종료(): void {
    const 영역크기 = this.계산된영역크기();
    document.body.style.cursor = 'default';
    
    // AI에게 확인 요청
    AI확인요청(`${영역크기.width}×${영역크기.height} 크기의 이미지 영역을 만들까요?`);
  }
}
```

### 비율 기반 생성
```typescript
const 비율옵션들 = {
  '정사각형': { ratio: '1:1', width: 200, height: 200 },
  '와이드': { ratio: '16:9', width: 320, height: 180 },
  '세로형': { ratio: '3:4', width: 240, height: 320 },
  '배너': { ratio: '5:1', width: 500, height: 100 },
  '프로필': { ratio: '1:1', width: 100, height: 100 },
  '커버이미지': { ratio: '3:1', width: 600, height: 200 }
};

const 비율선택UI = (
  <div className="비율-선택-패널">
    <h3>이미지 영역 크기를 선택하세요</h3>
    <div className="비율-그리드">
      {Object.entries(비율옵션들).map(([이름, 정보]) => (
        <div 
          key={이름}
          className="비율-옵션"
          onClick={() => this.비율로영역생성(정보)}
        >
          <div className="미리보기-박스" style={{
            width: '60px',
            height: `${60 * (정보.height / 정보.width)}px`,
            border: '2px solid #007bff',
            marginBottom: '8px'
          }}/>
          <div>{이름}</div>
          <div style={{ fontSize: '12px', color: '#666' }}>
            {정보.ratio}
          </div>
        </div>
      ))}
    </div>
  </div>
);
```

### 이미지 업로드 & 처리
```typescript
class 이미지처리시스템 {
  async 이미지업로드(파일: File, 영역정보: 영역크기): Promise<처리결과> {
    const 이미지URL = await this.파일을URL변환(파일);
    const 원본크기 = await this.이미지크기측정(이미지URL);
    
    const 처리옵션들 = this.처리옵션생성(원본크기, 영역정보);
    
    return {
      이미지URL,
      원본크기,
      처리옵션들,
      추천처리: this.최적처리방법추천(원본크기, 영역정보)
    };
  }
  
  처리옵션생성(원본: 크기정보, 영역: 크기정보): 처리옵션[] {
    return [
      {
        이름: '영역에 맞춤',
        설명: '이미지를 영역 크기에 정확히 맞춤 (비율 변경될 수 있음)',
        CSS: { width: '100%', height: '100%', objectFit: 'fill' }
      },
      {
        이름: '비율 유지하며 채우기',
        설명: '이미지 비율을 유지하며 영역을 가득 채움 (일부 잘릴 수 있음)',
        CSS: { width: '100%', height: '100%', objectFit: 'cover' }
      },
      {
        이름: '완전히 보이게',
        설명: '이미지 전체가 보이도록 맞춤 (여백 생길 수 있음)',
        CSS: { width: '100%', height: '100%', objectFit: 'contain' }
      }
    ];
  }
}
```

---

## 🎚️ 레이어(Z-Index) 관리 시스템

### 레이어 패널 UI
```typescript
interface 레이어정보 {
  id: string;
  이름: string;
  타입: '텍스트' | '이미지' | '아이콘' | '버튼' | '영역';
  zIndex: number;
  보임: boolean;
  잠김: boolean;
  미리보기: string;
}

const 레이어패널 = ({ 레이어들, 온변경 }: 레이어패널Props) => {
  return (
    <div className="레이어-패널">
      <div className="패널-헤더">
        <h3>레이어</h3>
        <button onClick={새레이어추가}>+ 추가</button>
      </div>
      
      <div className="레이어-목록">
        {레이어들
          .sort((a, b) => b.zIndex - a.zIndex) // 위에서부터 표시
          .map(레이어 => (
            <div 
              key={레이어.id}
              className={`레이어-아이템 ${레이어.선택됨 ? '선택됨' : ''}`}
              draggable
              onDragStart={(e) => 레이어드래그시작(e, 레이어)}
              onDrop={(e) => 레이어순서변경(e, 레이어)}
            >
              <div className="레이어-미리보기">
                {레이어.미리보기}
              </div>
              
              <div className="레이어-정보">
                <div className="레이어-이름">{레이어.이름}</div>
                <div className="레이어-타입">{레이어.타입}</div>
              </div>
              
              <div className="레이어-컨트롤">
                <button 
                  onClick={() => 레이어보임토글(레이어.id)}
                  title="보임/숨김"
                >
                  {레이어.보임 ? '👁️' : '🙈'}
                </button>
                
                <button 
                  onClick={() => 레이어잠금토글(레이어.id)}
                  title="잠금/해제"
                >
                  {레이어.잠김 ? '🔒' : '🔓'}
                </button>
                
                <button 
                  onClick={() => 레이어삭제(레이어.id)}
                  title="삭제"
                >
                  🗑️
                </button>
              </div>
            </div>
          ))}
      </div>
      
      <div className="레이어-도구">
        <button onClick={앞으로가져오기}>앞으로</button>
        <button onClick={뒤로보내기}>뒤로</button>
        <button onClick={최상단으로}>맨 앞으로</button>
        <button onClick={최하단으로}>맨 뒤로</button>
      </div>
    </div>
  );
};
```

### AI 레이어 관리 대화
```typescript
const 레이어AI대화 = {
  충돌감지(새요소: 요소정보): 충돌정보 | null {
    const 겹치는요소들 = this.현재레이어들.filter(레이어 => 
      this.영역겹침확인(새요소.위치, 레이어.위치)
    );
    
    if (겹치는요소들.length > 0) {
      return {
        충돌요소들: 겹치는요소들,
        해결방안들: [
          '새 요소를 앞으로 가져오기',
          '새 요소를 뒤로 보내기', 
          '겹치는 요소 이동',
          '투명도 조정'
        ]
      };
    }
    return null;
  },
  
  자동해결제안(충돌정보: 충돌정보): AI대화응답 {
    return {
      메시지: `추가하신 이미지가 ${충돌정보.충돌요소들[0].이름}와 겹쳐요. 어떻게 할까요?`,
      선택지: [
        {
          텍스트: '이미지를 앞으로 가져오기',
          액션: () => this.zIndex조정(새요소.id, '앞으로')
        },
        {
          텍스트: '배경으로 보내기', 
          액션: () => this.zIndex조정(새요소.id, '뒤로')
        },
        {
          텍스트: '투명하게 만들기',
          액션: () => this.투명도조정(새요소.id, 0.7)
        },
        {
          텍스트: '직접 조정할게요',
          액션: () => this.레이어패널열기()
        }
      ]
    };
  }
};
```

### 자동 레이어 정리
```typescript
class 스마트레이어관리 {
  자동정리(): void {
    // 1. 안 쓰는 레이어 정리
    const 빈레이어들 = this.레이어들.filter(레이어 => 레이어.내용없음);
    빈레이어들.forEach(레이어 => this.레이어삭제(레이어.id));
    
    // 2. Z-index 최적화 (1, 2, 3... 순서로 정리)
    this.zIndex최적화();
    
    // 3. 비슷한 레이어들 그룹화 제안
    const 그룹화제안 = this.그룹화분석();
    if (그룹화제안.length > 0) {
      this.그룹화제안표시(그룹화제안);
    }
  }
  
  zIndex최적화(): void {
    const 정렬된레이어들 = [...this.레이어들].sort((a, b) => a.zIndex - b.zIndex);
    
    정렬된레이어들.forEach((레이어, index) => {
      레이어.zIndex = (index + 1) * 10; // 10, 20, 30... 여유있게
    });
  }
}
```

---

## 🎯 통합 사용자 경험

### 시나리오 1: 아이콘 추가
```
사용자: "시계 아이콘 넣고 싶어"
AI: [시계 관련 아이콘들 5×4 그리드로 표시]
    "이런 시계 아이콘들 중에서 골라주세요!"

사용자: [둥근 시계 아이콘 선택]
AI: "어디에 넣을까요? 클릭해서 위치를 정해주세요"

사용자: [헤더 오른쪽 클릭]  
AI: "헤더 오른쪽에 시계 아이콘을 넣었어요. 크기나 색상을 바꾸고 싶으시면 말씀해주세요!"
```

### 시나리오 2: 이미지 영역 생성
```
사용자: "여기에 프로필 사진 넣고 싶어"
AI: "프로필 사진 영역을 만들어드릴게요!"
    [정사각형] [원형] [직접 그리기] [크기 지정]

사용자: [원형 선택]
AI: "원형 프로필 영역을 만들었어요 (100×100px). 
     이미지를 드래그해서 넣거나 파일을 선택해주세요"

사용자: [이미지 파일 드롭]
AI: "이미지가 좀 커서 자동으로 크기를 맞췄어요. 
     얼굴이 잘 나오도록 위치를 조정할까요?"
```

### 시나리오 3: 레이어 겹침 해결  
```
사용자: [이미지를 추가했는데 텍스트를 가림]
AI: "추가하신 이미지가 중요한 텍스트를 가리고 있어요! 
     어떻게 해결할까요?"
    
    [이미지를 뒤로 보내기] [텍스트를 앞으로] 
    [이미지 투명하게] [위치 조정]

사용자: [이미지를 뒤로 보내기 선택]
AI: "이미지를 배경 레이어로 이동했어요. 
     이제 텍스트가 잘 보이시죠?"
```

---

## 🚀 기술 구현 포인트

### 성능 최적화
- **지연 로딩**: 아이콘 라이브러리 필요시에만 로드
- **이미지 캐싱**: 자주 쓰는 아이콘들 브라우저 캐시 활용  
- **레이어 가상화**: 보이는 레이어만 렌더링

### 접근성 고려
- **키보드 네비게이션**: Tab, Arrow 키로 아이콘 선택
- **스크린리더**: 모든 아이콘에 적절한 alt 텍스트
- **고대비 모드**: 레이어 구분이 명확하도록

### 모바일 대응
- **터치 인터페이스**: 드래그 대신 탭으로 영역 생성
- **반응형 레이어 패널**: 작은 화면에서는 하단 시트로
- **제스처 지원**: 핀치 줌으로 이미지 크기 조정

이 시스템으로 **진짜 포토샵/피그마 수준의 레이어 관리**가 웹에서 가능해집니다! 🎨✨