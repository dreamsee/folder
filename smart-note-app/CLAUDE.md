# CLAUDE.md - 스마트노트 프로젝트 효율성 지침

## 🚨 필독: 프로젝트 작업 전 반드시 읽기
**📖 🧭_스마트노트앱_전체가이드.md ← 프로젝트 전체 맥락 파악 필수**

이 문서를 먼저 읽지 않고 작업하면:
- 분산된 철학과 아이디어를 놓칠 수 있음
- 잘못된 방향으로 개발할 위험
- 기존 결정사항과 충돌할 가능성

## 🎯 반복 작업 방지 최우선 원칙

**핵심**: 기존 파일 수정 > 새 파일 생성

### 🚫 절대 금지 사항
1. **마이그레이션 파일 중복 생성 금지**
   - 기존: `migration-7d-phase1.sql` 수정
   - 금지: `migration-7d-phase1-v2.sql`, `migration-fixed.sql` 등 생성
   
2. **문서 무분별 생성 금지**  
   - 7차원 관련 문서는 기존 파일에 섹션 추가
   - 가이드 문서는 기존 README.md에 통합

3. **TypeScript 동일 오류 반복 수정 금지**
   - 공통 오류는 `src/유틸/공통오류처리.ts`에 유틸리티화
   - 타입 캐스팅 문제는 표준 패턴 사용

## 🔑 키워드 기반 효율 작업

### 단일 에이전트 모드
```
"빠른." → 초고속 모드 (답변만, 설명 최소)
"수정." → 기존 파일 수정 우선 (새 파일 생성 금지)  
"통합." → 분산된 문서/파일들 하나로 병합
"정리." → 중복 제거 및 아카이브
"학습." → 패턴 저장 + 즉시 활용 + 시스템 업데이트
```

### 효율성 검증 질문
작업 전 반드시 확인:
1. "기존 파일을 수정할 수 있는가?" (YES → 수정, NO → 새 생성)
2. "이미 비슷한 문서가 있는가?" (YES → 통합, NO → 새 생성)  
3. "이 오류를 전에 해결한 적이 있는가?" (YES → 패턴 재사용, NO → 유틸리티화)

## 📁 파일 구조 표준

### 마이그레이션 관리
```
📁 root/
├── migration-7dimension-phase1-final.sql (최종 단일 버전)
├── migration-archive/ (이전 버전들)
└── migration-template.sql (향후 템플릿)
```

### 문서 구조
```
📁 root/
├── README.md (프로젝트 개요)
├── 개발진행상태.md (전체 현황)
├── 📁 작업일지/ (일별 세부 기록)
├── 📁 설계문서/ (아키텍처, 7차원 설계)
└── 📁 가이드/ (사용법, 배포 가이드)
```

### TypeScript 공통 패턴
```typescript
// ✅ 권장: 표준 유틸리티 사용
import { 안전한타입캐스팅 } from '../유틸/공통오류처리';
const 값 = 안전한타입캐스팅<감정강도타입>(계산결과);

// ❌ 지양: 직접 캐스팅 반복
const 값 = 계산결과 as 감정강도타입;
```

## 🇰🇷 한글 코딩 규칙

**핵심 원칙**: 비즈니스 로직은 한글, 기술 구조는 영어

```typescript
// ✅ 권장: 사용자상태 = useState<사용자타입>();
// ❌ 지양: userData = useState(); // 도메인 로직인데 영어
```

**예외**: React Hook, 라이브러리 함수, HTML 속성, CSS 클래스

## ⚡ 성능 최적화 원칙

1. **토큰 절약**: 90% 목표 (기존 5000+ → 500-1000)
2. **파일 읽기 최소화**: 필요시에만 읽기
3. **배치 작업**: 관련 수정사항 한 번에 처리
4. **캐시 활용**: 이전 분석 결과 재사용

## 🚨 예외 상황

**새 파일 생성 허용 조건**:
1. 완전히 새로운 기능 (기존 파일과 연관성 < 30%)
2. 파일 크기가 500줄 초과하여 분리 필요
3. 서로 다른 도메인 (UI vs 백엔드 vs 테스트)

**즉시 중단하고 사용자에게 질문해야 하는 경우**:
1. 동일한 오류를 3번째 수정할 때
2. 비슷한 문서를 2번째 생성하려 할 때  
3. 마이그레이션 파일을 수정이 아닌 생성하려 할 때

---
*효율성 최우선: 필요할 때만 필요한 만큼*